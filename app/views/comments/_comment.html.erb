<div class="bg-gray-50 p-4 rounded-lg">
  <div class="flex items-start space-x-4">
    <% if comment.user&.avatar&.attached? %>
      <%= image_tag comment.user.avatar, class: "w-10 h-10 rounded-full" %>
    <% else %>
      <div class="w-10 h-10 bg-gray-300 rounded-full"></div>
    <% end %>
    <div class="w-full">
      <p class="text-gray-700"><%= comment.content %></p>
      <p class="text-sm text-gray-500 mt-1">
        By <%= comment.user.username %> â€¢ <%= time_ago_in_words(comment.created_at) %> ago
      </p>
      <!-- Reply Button -->
      <% if user_signed_in? %>
        <%= link_to "Reply", "#", class: "text-blue-500 text-sm hover:underline", data: { toggle: "reply-form-#{comment.id}" }, role: "button", tabindex: "0" %>
        <div id="reply-form-<%= comment.id %>" class="hidden mt-2">
          <%= form_with model: [comment.post, Comment.new], local: true do |f| %>
            <%= f.hidden_field :parent_id, value: comment.id %>
            <div class="mt-2">
              <%= f.text_area :content, class: "w-full p-2 border rounded-md", placeholder: "Write your reply..." %>
            </div>
            <div class="mt-2">
              <%= f.submit "Reply", class: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-500 font-medium transition" %>
            </div>
          <% end %>
        </div>
      <% end %>
      <!-- Render Nested Replies -->
      <% if comment.replies.any? %>
        <div class="ml-8 mt-4 border-l-2 pl-4 border-gray-200 space-y-4">
          <%= render partial: "comments/comment", collection: comment.replies, as: :comment %>
        </div>
      <% end %>
    </div>
  </div>
</div>
