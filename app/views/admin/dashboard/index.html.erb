<% content_for :page_title, "Dashboard" %>
<% content_for :page_subtitle, "" %>

<!-- Compact Admin Dashboard - Table-Style Layout -->
<div class="bg-gradient-to-br from-gray-50 via-blue-50/30 to-gray-100 dark:bg-gradient-to-br dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 min-h-screen -m-6">
  <!-- Compact Header -->
  <div class="bg-gradient-to-r from-blue-600 to-blue-700 dark:from-gray-800 dark:to-gray-900 px-4 py-4">
    <div class="max-w-7xl mx-auto">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="relative">
            <% if current_user&.avatar&.attached? %>
              <%= image_tag current_user.avatar, class: "w-10 h-10 rounded-full object-cover border-2 border-white/20" %>
            <% else %>
              <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center border-2 border-white/20">
                <span class="text-sm font-semibold text-white"><%= current_user&.username&.first&.upcase || 'A' %></span>
              </div>
            <% end %>
            <div class="absolute -bottom-0.5 -right-0.5">
              <% if current_user&.online? %>
                <div class="w-3 h-3 bg-green-400 border-2 border-white rounded-full"></div>
              <% else %>
                <div class="w-3 h-3 bg-gray-400 border-2 border-white rounded-full"></div>
              <% end %>
            </div>
          </div>
          <div>
            <h1 class="text-lg font-semibold text-white">
              <%= time_based_greeting %>, <%= current_user&.display_name || current_user&.username || 'Admin' %>!
            </h1>
            <p class="text-sm text-blue-100">Admin Dashboard - <%= Date.current.strftime("%B %d, %Y") %></p>
          </div>
        </div>
        
        <% case current_user&.role %>
        <% when 'admin' %>
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-500/20 text-red-100 border border-red-400/30">
            <i class="fas fa-crown mr-1.5"></i>
            System Administrator
          </span>
        <% when 'moderator' %>
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-500/20 text-yellow-100 border border-yellow-400/30">
            <i class="fas fa-shield-alt mr-1.5"></i>
            Forum Moderator
          </span>
        <% else %>
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/20 text-white border border-white/30">
            <i class="fas fa-user mr-1.5"></i>
            <%= current_user&.role&.humanize || 'User' %>
          </span>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Main Content - Compact Table Layout -->
  <div class="p-6 max-w-7xl mx-auto">
    <div class="bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm rounded-2xl border border-white/20 dark:border-gray-700/50 p-6 shadow-xl">
      <div class="bg-gradient-to-r from-white/40 via-white/60 to-white/40 dark:from-gray-800/40 dark:via-gray-800/60 dark:to-gray-800/40 rounded-xl p-1 mb-6 shadow-inner">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-4">
  <!-- Primary Statistics Grid - Centered & Bold Clickable Cards -->
  <div class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8">
    
    <!-- Total Users -->
    <%= link_to admin_users_path, class: "bg-gradient-to-br from-white via-blue-50/50 to-blue-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-blue-200/50 dark:border-blue-700/30 p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
      <div class="flex flex-col items-center text-center space-y-3">
        <div class="p-4 bg-blue-100 dark:bg-blue-900/30 rounded-xl group-hover:scale-110 group-hover:bg-blue-200 dark:group-hover:bg-blue-900/50 transition-all duration-200">
          <i class="fas fa-users text-blue-600 dark:text-blue-400 text-2xl"></i>
        </div>
        <div>
          <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Users</p>
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
            <%= number_with_delimiter(@stats[:users][:total]) %>
          </h3>
          <p class="text-xs font-bold text-green-600 dark:text-green-400 mt-1">+<%= @stats[:users][:new_today] %> today</p>
        </div>
      </div>
    <% end %>

    <!-- Total Posts -->
    <%= link_to admin_posts_path, class: "bg-gradient-to-br from-white via-green-50/50 to-green-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-green-200/50 dark:border-green-700/30 p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
      <div class="flex flex-col items-center text-center space-y-3">
        <div class="p-4 bg-green-100 dark:bg-green-900/30 rounded-xl group-hover:scale-110 group-hover:bg-green-200 dark:group-hover:bg-green-900/50 transition-all duration-200">
          <i class="fas fa-newspaper text-green-600 dark:text-green-400 text-2xl"></i>
        </div>
        <div>
          <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Posts</p>
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors">
            <%= number_with_delimiter(@stats[:posts][:total]) %>
          </h3>
          <p class="text-xs font-bold text-green-600 dark:text-green-400 mt-1">+<%= @stats[:posts][:new_today] %> today</p>
        </div>
      </div>
    <% end %>

    <!-- Total Comments -->
    <%= link_to admin_comments_path, class: "bg-gradient-to-br from-white via-yellow-50/50 to-yellow-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-yellow-200/50 dark:border-yellow-700/30 p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
      <div class="flex flex-col items-center text-center space-y-3">
        <div class="p-4 bg-yellow-100 dark:bg-yellow-900/30 rounded-xl group-hover:scale-110 group-hover:bg-yellow-200 dark:group-hover:bg-yellow-900/50 transition-all duration-200">
          <i class="fas fa-comments text-yellow-600 dark:text-yellow-400 text-2xl"></i>
        </div>
        <div>
          <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Comments</p>
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white group-hover:text-yellow-600 dark:group-hover:text-yellow-400 transition-colors">
            <%= number_with_delimiter(@stats[:comments][:total]) %>
          </h3>
          <p class="text-xs font-bold text-green-600 dark:text-green-400 mt-1">+<%= @stats[:comments][:new_today] %> today</p>
        </div>
      </div>
    <% end %>

    <!-- Categories -->
    <%= link_to admin_categories_path, class: "bg-gradient-to-br from-white via-purple-50/50 to-purple-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-purple-200/50 dark:border-purple-700/30 p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
      <div class="flex flex-col items-center text-center space-y-3">
        <div class="p-4 bg-purple-100 dark:bg-purple-900/30 rounded-xl group-hover:scale-110 group-hover:bg-purple-200 dark:group-hover:bg-purple-900/50 transition-all duration-200">
          <i class="fas fa-tags text-purple-600 dark:text-purple-400 text-2xl"></i>
        </div>
        <div>
          <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Categories</p>
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors">
            <%= number_with_delimiter(@stats[:categories][:total]) %>
          </h3>
          <p class="text-xs font-bold text-gray-500 dark:text-gray-400 mt-1">
            <%= @stats[:categories][:with_posts] %> active
          </p>
        </div>
      </div>
    <% end %>

  </div>



    <!-- Secondary Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      
      <!-- Quick Actions Section -->
      <div class="lg:col-span-1">
        <!-- Quick Actions Grid - Centered & Bold Clickable Cards -->
        <div class="grid grid-cols-2 gap-4 mb-6">
          
          <!-- Add User Action -->
          <%= link_to new_admin_user_path, class: "bg-gradient-to-br from-white via-blue-50/40 to-blue-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-blue-200/40 dark:border-blue-700/30 p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
            <div class="flex flex-col items-center text-center space-y-3">
              <div class="p-4 bg-blue-100 dark:bg-blue-900/30 rounded-xl group-hover:scale-110 group-hover:bg-blue-200 dark:group-hover:bg-blue-900/50 transition-all duration-200">
                <i class="fas fa-user-plus text-blue-600 dark:text-blue-400 text-xl"></i>
              </div>
              <div>
                <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Add User</p>
                <p class="text-sm font-bold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
                  Create Account
                </p>
              </div>
            </div>
          <% end %>

          <!-- Create Post Action -->
          <%= link_to new_admin_post_path, class: "bg-gradient-to-br from-white via-green-50/40 to-green-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-green-200/40 dark:border-green-700/30 p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
            <div class="flex flex-col items-center text-center space-y-3">
              <div class="p-4 bg-green-100 dark:bg-green-900/30 rounded-xl group-hover:scale-110 group-hover:bg-green-200 dark:group-hover:bg-green-900/50 transition-all duration-200">
                <i class="fas fa-plus text-green-600 dark:text-green-400 text-xl"></i>
              </div>
              <div>
                <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">New Post</p>
                <p class="text-sm font-bold text-gray-900 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors">
                  Create Content
                </p>
              </div>
            </div>
          <% end %>

          <!-- Moderate Comments Action -->
          <%= link_to admin_comments_path, class: "bg-gradient-to-br from-white via-yellow-50/40 to-yellow-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-yellow-200/40 dark:border-yellow-700/30 p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
            <div class="flex flex-col items-center text-center space-y-3">
              <div class="p-4 bg-yellow-100 dark:bg-yellow-900/30 rounded-xl group-hover:scale-110 group-hover:bg-yellow-200 dark:group-hover:bg-yellow-900/50 transition-all duration-200">
                <i class="fas fa-shield-alt text-yellow-600 dark:text-yellow-400 text-xl"></i>
              </div>
              <div>
                <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Moderate</p>
                <p class="text-sm font-bold text-gray-900 dark:text-white group-hover:text-yellow-600 dark:group-hover:text-yellow-400 transition-colors">
                  Review Content
                </p>
              </div>
            </div>
          <% end %>

          <!-- Export Data Action -->
          <%= link_to export_admin_users_path(format: 'csv'), class: "bg-gradient-to-br from-white via-purple-50/40 to-purple-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-purple-200/40 dark:border-purple-700/30 p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
            <div class="flex flex-col items-center text-center space-y-3">
              <div class="p-4 bg-purple-100 dark:bg-purple-900/30 rounded-xl group-hover:scale-110 group-hover:bg-purple-200 dark:group-hover:bg-purple-900/50 transition-all duration-200">
                <i class="fas fa-download text-purple-600 dark:text-purple-400 text-xl"></i>
              </div>
              <div>
                <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Export</p>
                <p class="text-sm font-bold text-gray-900 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors">
                  Download Data
                </p>
              </div>
            </div>
          <% end %>
          
        </div>
        
        <!-- Recent Users Section -->
        <div class="space-y-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2">
              <div class="p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg">
                <i class="fas fa-user-clock text-blue-600 dark:text-blue-400 text-sm"></i>
              </div>
              <h3 class="text-sm font-semibold text-gray-900 dark:text-white">Recent Users</h3>
            </div>
            <%= link_to admin_users_path, class: "text-xs text-blue-600 dark:text-blue-400 hover:underline font-medium" do %>
              View all →
            <% end %>
          </div>
          
          <div class="grid grid-cols-1 gap-3">
            <% @recent_users.limit(4).each do |user| %>
              <%= link_to admin_user_path(user), class: "bg-gradient-to-r from-white via-blue-50/30 to-white dark:bg-gradient-to-r dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-blue-200/30 dark:border-blue-700/20 p-4 shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
                <div class="flex items-center space-x-3">
                  <% if user.avatar.attached? %>
                    <%= image_tag user.avatar, class: "w-10 h-10 rounded-full object-cover group-hover:scale-110 transition-transform duration-200" %>
                  <% else %>
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center group-hover:scale-110 transition-transform duration-200">
                      <span class="text-sm font-bold text-white"><%= user.username&.first&.upcase || 'U' %></span>
                    </div>
                  <% end %>
                  <div class="flex-1 min-w-0">
                    <p class="text-sm font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"><%= truncate(user.display_name, length: 18) %></p>
                    <p class="text-xs font-medium text-gray-500 dark:text-gray-400">Joined <%= time_ago_in_words(user.created_at) %> ago</p>
                  </div>
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold <%= case user.role
                    when 'admin' then 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'
                    when 'moderator' then 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400'
                    else 'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300'
                  end %>">
                    <%= user.role.capitalize %>
                  </span>
                </div>
              <% end %>
            <% end %>
            
            <% if @recent_users.limit(4).count == 0 %>
              <div class="bg-gradient-to-br from-white via-gray-50/50 to-gray-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-gray-200/50 dark:border-gray-700/30 p-6 shadow-lg text-center backdrop-blur-sm">
                <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg mb-3 mx-auto w-12 h-12 flex items-center justify-center">
                  <i class="fas fa-users text-gray-400 dark:text-gray-500"></i>
                </div>
                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">No recent users</p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
      
      <!-- Charts Section -->
      <div class="lg:col-span-2">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6">
          <!-- User Growth Chart -->
          <div class="bg-gradient-to-br from-white via-blue-50/30 to-white dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-blue-200/40 dark:border-blue-700/30 p-5 shadow-lg backdrop-blur-sm">
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center space-x-2">
                <div class="p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg">
                  <i class="fas fa-chart-line text-blue-600 dark:text-blue-400 text-sm"></i>
                </div>
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 dark:text-white">User Growth</h3>
                  <p class="text-xs text-gray-500 dark:text-gray-400">Last 30 days</p>
                </div>
              </div>
              <div class="flex space-x-1">
                <button class="px-3 py-1.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" onclick="filterActivityData('week')">
                  7D
                </button>
                <button class="px-3 py-1.5 text-xs bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-lg">
                  30D
                </button>
              </div>
            </div>
            <div class="relative" style="height: 200px;">
              <canvas id="userGrowthChart" class="w-full h-full"></canvas>
            </div>
          </div>
          
          <!-- Content Activity Chart -->
          <div class="bg-gradient-to-br from-white via-green-50/30 to-white dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-green-200/40 dark:border-green-700/30 p-5 shadow-lg backdrop-blur-sm">
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center space-x-2">
                <div class="p-2 bg-green-100 dark:bg-green-900/30 rounded-lg">
                  <i class="fas fa-chart-bar text-green-600 dark:text-green-400 text-sm"></i>
                </div>
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 dark:text-white">Content Activity</h3>
                  <p class="text-xs text-gray-500 dark:text-gray-400">Posts & Comments</p>
                </div>
              </div>
              <div class="flex items-center space-x-4 text-xs">
                <div class="flex items-center">
                  <div class="w-2 h-2 bg-green-500 rounded-full mr-1.5"></div>
                  <span class="text-gray-600 dark:text-gray-400 font-medium">Posts</span>
                </div>
                <div class="flex items-center">
                  <div class="w-2 h-2 bg-yellow-500 rounded-full mr-1.5"></div>
                  <span class="text-gray-600 dark:text-gray-400 font-medium">Comments</span>
                </div>
              </div>
            </div>
            <div class="relative" style="height: 200px;">
              <canvas id="contentActivityChart" class="w-full h-full"></canvas>
            </div>
          </div>
        </div>
        
        <!-- Recent Posts & Comments as Individual Cards -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          
          <!-- Recent Posts -->
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <div class="p-2 bg-green-100 dark:bg-green-900/30 rounded-lg">
                  <i class="fas fa-newspaper text-green-600 dark:text-green-400 text-sm"></i>
                </div>
                <h3 class="text-sm font-semibold text-gray-900 dark:text-white">Recent Posts</h3>
              </div>
              <%= link_to admin_posts_path, class: "text-xs text-blue-600 dark:text-blue-400 hover:underline font-medium" do %>
                View all →
              <% end %>
            </div>
            
            <div class="space-y-3">
              <% @recent_posts.limit(3).each do |post| %>
                <%= link_to post_path(post), class: "block bg-gradient-to-r from-white via-green-50/30 to-white dark:bg-gradient-to-r dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-green-200/30 dark:border-green-700/20 p-4 shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
                  <div class="flex items-start space-x-3">
                    <div class="p-2 bg-green-100 dark:bg-green-900/30 rounded-lg group-hover:scale-110 transition-transform duration-200">
                      <i class="fas fa-newspaper text-green-600 dark:text-green-400 text-sm"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                      <p class="text-sm font-bold text-gray-900 dark:text-white truncate mb-1 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors">
                        <%= truncate(post.title, length: 35) %>
                      </p>
                      <div class="flex items-center justify-between">
                        <p class="text-xs font-medium text-gray-500 dark:text-gray-400">
                          by <%= truncate(post.user.display_name, length: 15) %> • <%= time_ago_in_words(post.created_at) %> ago
                        </p>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400">
                          <%= truncate(post.category.name, length: 8) %>
                        </span>
                      </div>
                    </div>
                  </div>
                <% end %>
              <% end %>
              
              <% if @recent_posts.limit(3).count == 0 %>
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm text-center">
                  <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg mb-3 mx-auto w-12 h-12 flex items-center justify-center">
                    <i class="fas fa-newspaper text-gray-400 dark:text-gray-500"></i>
                  </div>
                  <p class="text-sm font-medium text-gray-500 dark:text-gray-400">No recent posts</p>
                </div>
              <% end %>
            </div>
          </div>
          
          <!-- Recent Comments -->
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <div class="p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg">
                  <i class="fas fa-comments text-yellow-600 dark:text-yellow-400 text-sm"></i>
                </div>
                <h3 class="text-sm font-semibold text-gray-900 dark:text-white">Recent Comments</h3>
              </div>
              <%= link_to admin_comments_path, class: "text-xs text-blue-600 dark:text-blue-400 hover:underline font-medium" do %>
                Moderate →
              <% end %>
            </div>
            
            <div class="space-y-3">
              <% @recent_comments.limit(3).each do |comment| %>
                <%= link_to post_path(comment.post), class: "block bg-gradient-to-r from-white via-yellow-50/30 to-white dark:bg-gradient-to-r dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-yellow-200/30 dark:border-yellow-700/20 p-4 shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
                  <div class="flex items-start space-x-3">
                    <div class="p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg group-hover:scale-110 transition-transform duration-200">
                      <i class="fas fa-comments text-yellow-600 dark:text-yellow-400 text-sm"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                      <p class="text-sm font-bold text-gray-700 dark:text-gray-300 line-clamp-2 mb-2 group-hover:text-yellow-600 dark:group-hover:text-yellow-400 transition-colors">
                        <%= truncate(strip_tags(comment.content), length: 50) %>
                      </p>
                      <div class="flex items-center justify-between">
                        <p class="text-xs font-medium text-gray-500 dark:text-gray-400">
                          by <%= truncate(comment.user.display_name, length: 12) %> • <%= time_ago_in_words(comment.created_at) %> ago
                        </p>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400">
                          <%= truncate(comment.post.title, length: 15) %>
                        </span>
                      </div>
                    </div>
                  </div>
                <% end %>
              <% end %>
              
              <% if @recent_comments.limit(3).count == 0 %>
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm text-center">
                  <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg mb-3 mx-auto w-12 h-12 flex items-center justify-center">
                    <i class="fas fa-comments text-gray-400 dark:text-gray-500"></i>
                  </div>
                  <p class="text-sm font-medium text-gray-500 dark:text-gray-400">No recent comments</p>
                </div>
              <% end %>
            </div>
          </div>
          
        </div>
      </div>
      
    </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Dashboard Chart Data -->
<script>
  // Set chart data as global variables for the admin_dashboard.js module
  window.userGrowthLabels = <%= raw @user_growth_data.keys.to_json %>;
  window.userGrowthData = <%= raw @user_growth_data.values.to_json %>;
  window.postActivityLabels = <%= raw @post_activity_data.keys.to_json %>;
  window.postActivityData = <%= raw @post_activity_data.values.to_json %>;
  window.commentActivityData = <%= raw @comment_activity_data.values.to_json %>;
</script>
