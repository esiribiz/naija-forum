<% content_for :title, "Categories" %>
<div class="flex">
  <!-- Main Content -->
  <main class="flex-1 p-6 bg-gray-50">
    <%= render 'shared/navigation_menu' %>
    <!-- Notification Section -->
    <% if notice.present? %>
      <p class="py-3 px-5 bg-green-50 border-l-4 border-green-500 text-green-700 rounded-lg mb-6" id="notice">
        <%= notice %>
      </p>
    <% end %>
    
    <!-- Header with Nigerian color theme -->
    <div class="bg-gradient-to-r from-green-600 to-green-700 text-white p-6 rounded-xl mb-8 shadow-md relative overflow-hidden">
      <div class="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-10 -mt-10"></div>
      <div class="absolute bottom-0 left-0 w-24 h-24 bg-white opacity-10 rounded-full -ml-8 -mb-8"></div>
      
      <div class="flex justify-between items-center relative z-10">
        <h1 class="text-3xl font-bold">Categories</h1>
        <% if user_signed_in? && current_user.admin? %>
          <%= link_to new_category_path, class: "px-5 py-2.5 bg-white text-green-700 rounded-lg hover:bg-green-50 font-medium shadow-sm transition duration-300 flex items-center space-x-2 hover:shadow-md" do %>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5">
              <path fill-rule="evenodd" d="M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z" clip-rule="evenodd" />
            </svg>
            <span>New Category</span>
          <% end %>
        <% end %>
      </div>
    </div>
    
    <!-- Categories List Section -->
    <div id="categories" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
      <% if @categories.any? %>
        <% @categories.each do |category| %>
          <div class="bg-white rounded-xl shadow-md hover:shadow-lg transition-all duration-300 overflow-hidden border-l-4 border-green-500 transform hover:scale-102">
            <!-- Category Color and Image Prefix -->
            <div class="flex items-center space-x-4 p-5 border-b border-gray-100">
              <div class="w-12 h-12 flex items-center justify-center rounded-full text-lg font-bold text-white ring-2 ring-green-100" style="background-color: <%= category.color.presence || '#10B981' %>">
                <% if category.image.attached? %>
                  <%= image_tag category.image, class: "w-full h-full object-cover rounded-full" %>
                <% else %>
                  <%= category.name[0..1].upcase %>
                <% end %>
              </div>
              <div>
                <h2 class="text-xl font-bold text-gray-800 group">
                  <%= link_to category_path(category), class: "hover:text-green-600 transition-colors duration-200" do %>
                    <%= category.name %>
                    <span class="block h-0.5 w-0 bg-green-500 transition-all duration-300 group-hover:w-full"></span>
                  <% end %>
                </h2>
                <p class="text-sm text-gray-500 flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 mr-1">
                    <path fill-rule="evenodd" d="M4.125 3C3.089 3 2.25 3.84 2.25 4.875V18a3 3 0 003 3h15a3 3 0 01-3-3V4.875C17.25 3.839 16.41 3 15.375 3H4.125zM12 9.75a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H12zm-.75-2.25a.75.75 0 01.75-.75h1.5a.75.75 0 010 1.5H12a.75.75 0 01-.75-.75zM6 12.75a.75.75 0 000 1.5h7.5a.75.75 0 000-1.5H6zm-.75 3.75a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5H6a.75.75 0 01-.75-.75zM6 6.75a.75.75 0 00-.75.75v3c0 .414.336.75.75.75h3a.75.75 0 00.75-.75v-3A.75.75 0 009 6.75H6z" clip-rule="evenodd" />
                  </svg>
                  <%= pluralize(category.posts.count, "post") rescue "0 posts" %>
                </p>
              </div>
            </div>
            
            <div class="p-5">
              <p class="text-gray-700 leading-relaxed">
                <%= truncate(category.description, length: 150) %>
              </p>
              
              <% if user_signed_in? && current_user.admin? %>
                <div class="mt-6 pt-4 border-t border-gray-100 flex justify-end space-x-4">
                  <%= link_to edit_category_path(category), class: "text-amber-500 hover:text-amber-600 transition-colors flex items-center" do %>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-1">
                      <path d="M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z" />
                    </svg>
                    Edit
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      <% else %>
        <div class="col-span-full bg-white p-8 rounded-xl shadow text-center">
          <p class="text-gray-500 text-lg">No categories available yet.</p>
        </div>
      <% end %>
    </div>
    
    <!-- Pagination if needed -->
    <% if @categories.respond_to?(:total_pages) && @categories.total_pages > 1 %>
      <div class="mt-8 flex justify-center">
        <%= paginate @categories, class: "inline-flex shadow-sm rounded-md overflow-hidden" %>
      </div>
    <% end %>
  </main>
</div>
