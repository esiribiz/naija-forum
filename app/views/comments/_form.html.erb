<%= form_with(
    model: [@post, comment],
    class: "comment-form space-y-4 #{comment.parent_id.present? ? 'reply-form' : ''}",
    data: {
    controller: "reset-form",
    action: "turbo:submit-end->reset-form#reset"
    }
) do |f| %>
<% if comment.errors.any? %>
    <div class="error-messages bg-red-50 text-red-500 p-4 rounded-lg mb-4">
    <h2><%= pluralize(comment.errors.count, "error") %> prohibited this comment from being saved:</h2>
    <ul>
        <% comment.errors.full_messages.each do |message| %>
        <li><%= message %></li>
        <% end %>
    </ul>
    </div>
<% end %>

<div class="relative">
<%= f.text_area :content, 
    rows: 3,
    class: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
    placeholder: comment.parent_id.present? ? "Write a reply..." : "Write a comment..." %>
</div>

<% if comment.parent_id.present? %>
<%= f.hidden_field :parent_id %>
<% end %>

<div class="flex justify-end space-x-2">
<% if comment.parent_id.present? %>
    <button type="button" 
            class="px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors duration-200"
            data-controller="comments"
            data-action="click->comments#toggleReplyForm"
            data-comment-id="<%= comment.parent_id %>">
    Cancel
    </button>
<% end %>
<%= f.submit comment.parent_id.present? ? "Reply" : "Comment", 
    class: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200" %>
</div>
<% end %>
