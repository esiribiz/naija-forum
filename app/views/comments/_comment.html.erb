<turbo-frame id="comment_<%= comment.id %>">
<div class="bg-white p-4 rounded-lg shadow-sm mb-4 border border-gray-100 <%= comment.parent_id.present? ? 'ml-8' : '' %>">
    <div class="flex items-start space-x-3">
    <div class="flex-shrink-0">
        <% if comment.user.avatar.attached? %>
        <%= image_tag comment.user.avatar, class: "h-10 w-10 rounded-full" %>
        <% else %>
        <div class="h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center">
            <span class="text-gray-500 text-sm font-medium">
            <%= comment.user.username.first(2).upcase %>
            </span>
        </div>
        <% end %>
    </div>
    
    <div class="flex-grow">
        <div class="flex items-center mb-1">
        <span class="font-medium text-gray-900"><%= comment.user.username %></span>
        <span class="text-gray-500 text-sm ml-2">
            <%= time_ago_in_words(comment.created_at) %> ago
        </span>
        </div>
        
        <div class="text-gray-700 mb-2">
        <%= comment.content %>
        </div>
        
        <div class="flex items-center space-x-4 text-sm">
        <% if current_user == comment.user %>
            <%= link_to "Edit", 
                edit_post_comment_path(comment.post, comment), 
                class: "text-blue-600 hover:text-blue-800",
                data: { turbo_frame: "comment_#{comment.id}" } %>
                
            <%= button_to "Delete", 
                post_comment_path(comment.post, comment), 
                method: :delete, 
                class: "text-red-600 hover:text-red-800",
                form: { data: { turbo_confirm: "Are you sure?" } } %>
        <% end %>
        
        <% unless comment.parent_id.present? %>
            <button type="button"
                    class="text-gray-600 hover:text-gray-800"
                    data-controller="comments"
                    data-action="click->comments#toggleReplyForm"
                    data-comment-id="<%= comment.id %>">
            Reply
            </button>
        <% end %>
        </div>
        
        <% unless comment.parent_id.present? %>
        <div id="reply_form_<%= comment.id %>" 
            class="reply-form hidden mt-4"
            data-comments-target="replyForm">
            <%= render 'comments/form', 
                comment: Comment.new(parent_id: comment.id), 
                post: comment.post %>
        </div>

        <div id="comment_<%= comment.id %>_replies" class="replies mt-4">
            <%= render comment.replies %>
        </div>
        <% end %>
    </div>
    </div>
</div>
</turbo-frame>
