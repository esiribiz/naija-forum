<div class="max-w-4xl mx-auto px-6 py-12">
  <h1 class="text-4xl font-extrabold text-gray-800 mb-6 text-center">
    Search Results for "<span class="bg-yellow-300 px-2 py-1 rounded-md"><%= @query %></span>"
  </h1>

  <% if @posts.any? || @categories.any? || @users.any? %>
    <div class="grid gap-8">

      <!-- Posts Section -->
      <% if @posts.any? %>
        <div>
          <h2 class="text-2xl font-semibold text-blue-600 mb-4">ğŸ“Œ Posts</h2>
          <div class="grid gap-6 md:grid-cols-2">
            <% @posts.each do |post| %>
              <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition relative cursor-pointer group">
                <% if user_signed_in? %>
                  <%= link_to post_path(post), class: "absolute inset-0 z-10 rounded-lg" do %>
                    <span class="sr-only">View <%= post.title %></span>
                  <% end %>
                <% else %>
                  <%= link_to new_user_session_path, class: "absolute inset-0 z-10 rounded-lg" do %>
                    <span class="sr-only">Sign in to view <%= post.title %></span>
                  <% end %>
                <% end %>
                
                <h3 class="text-lg font-bold text-gray-900 group-hover:text-blue-600 transition-colors">
                  <%= highlight_text(post.title, @query) %>
                  <% unless user_signed_in? %>
                    <span class="block text-xs text-blue-600 font-normal mt-1">ğŸ”’ Sign in to read this post</span>
                  <% end %>
                </h3>
                <p class="text-gray-600 mt-2 line-clamp-2 group-hover:text-gray-800 transition-colors">
                  <%= highlight_text(truncate(post.body, length: 100), @query) %>
                </p>
                <div class="mt-3 flex justify-between items-center text-sm text-gray-500 group-hover:text-gray-600 transition-colors">
                  <span>ğŸ–Š By <%= post.user.username %></span>
                  <span>ğŸ“… <%= post.created_at.strftime("%b %d, %Y") %></span>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>

      <!-- Categories Section -->
      <% if @categories.any? %>
        <div>
          <h2 class="text-2xl font-semibold text-green-600 mb-4">ğŸ“‚ Categories</h2>
          <div class="grid gap-6 md:grid-cols-2">
            <% @categories.each do |category| %>
              <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition">
                <h3 class="text-lg font-bold text-gray-900">
                  <%= link_to highlight_text(category.name, @query), category_posts_path(category), class: "hover:text-green-600" %>
                </h3>
                <p class="text-gray-600 mt-2">Explore posts related to this category.</p>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>

      <!-- Tags Section -->
      <% if @tags.any? %>
        <div>
          <h2 class="text-2xl font-semibold text-green-600 mb-4">ğŸ“‚ Tags</h2>
          <div class="grid gap-6 md:grid-cols-2">
            <% @tags.each do |tag| %>
              <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition">
                <h3 class="text-lg font-bold text-gray-900">
                  <%= link_to highlight_text(tag.name, @query), tag_posts_path(tag), class: "hover:text-green-600" %>
                </h3>
                <p class="text-gray-600 mt-2">Explore posts related to this tag.</p>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>

      <!-- Users Section -->
      <% if @users.any? %>
        <div>
          <h2 class="text-2xl font-semibold text-purple-600 mb-4">ğŸ‘¤ Users</h2>
          <div class="grid gap-6 md:grid-cols-2">
            <% @users.each do |user| %>
              <div class="flex items-center bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition">
                <div class="flex-shrink-0">
                  <% if user.avatar.attached? %>
                    <%= image_tag user.avatar, class: "w-12 h-12 rounded-full border border-gray-300 shadow-sm" %>
                  <% else %>
                    <img src="https://via.placeholder.com/50" class="w-12 h-12 rounded-full border border-gray-300 shadow-sm" alt="User Avatar">
                  <% end %>
                </div>
                <div class="ml-4">
                  <h3 class="text-lg font-bold text-gray-900">
                    <%= link_to highlight_text(user.username, @query), user_path(user), class: "hover:text-purple-600" %>
                  </h3>
                  <p class="text-gray-600 text-sm">Member since <%= user.created_at.strftime("%b %d, %Y") %></p>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>

    </div>
  <% else %>
    <div class="text-center mt-12">
      <p class="text-gray-500 text-lg">âŒ No results found for "<%= @query %>". Try a different keyword.</p>
      <a href="/" class="mt-4 inline-block px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-500 transition">
        ğŸ”„ Back to Home
      </a>
    </div>
  <% end %>
</div>
