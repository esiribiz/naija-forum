<% content_for :page_title, "Dashboard" %>
<% content_for :page_subtitle, "" %>

<!-- Skip Navigation Links -->
<div class="sr-only">
  <a href="#main-content" class="skip-link focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded-lg z-50">Skip to main content</a>
  <a href="#statistics-section" class="skip-link focus:not-sr-only focus:absolute focus:top-4 focus:left-32 bg-blue-600 text-white px-4 py-2 rounded-lg z-50">Skip to statistics</a>
</div>

<!-- Compact Admin Dashboard - Table-Style Layout -->
<main id="main-content" class="bg-gradient-to-br from-gray-50 via-blue-50/30 to-gray-100 dark:bg-gradient-to-br dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 min-h-screen -m-6" role="main" aria-label="Admin Dashboard">
  <!-- Compact Header -->
  <div class="bg-gradient-to-r from-blue-600 to-blue-700 dark:from-gray-800 dark:to-gray-900 px-4 py-4">
    <div class="max-w-7xl mx-auto">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="relative">
            <% if current_user&.avatar&.attached? %>
              <%= image_tag current_user.avatar, class: "w-10 h-10 rounded-full object-cover border-2 border-white/20" %>
            <% else %>
              <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center border-2 border-white/20">
                <span class="text-sm font-semibold text-white"><%= current_user&.username&.first&.upcase || 'A' %></span>
              </div>
            <% end %>
            <div class="absolute -bottom-0.5 -right-0.5">
              <% if current_user&.online? %>
                <div class="w-3 h-3 bg-green-400 border-2 border-white rounded-full"></div>
              <% else %>
                <div class="w-3 h-3 bg-gray-400 border-2 border-white rounded-full"></div>
              <% end %>
            </div>
          </div>
          <div>
            <h1 class="text-lg font-semibold text-white">
              <%= time_based_greeting %>, <%= current_user&.display_name || current_user&.username || 'Admin' %>!
            </h1>
            <p class="text-sm text-blue-100">Admin Dashboard - <%= Date.current.strftime("%B %d, %Y") %></p>
          </div>
        </div>
        
        <div class="flex items-center space-x-3">
          <!-- System Status Indicator -->
          <div class="flex items-center space-x-2 bg-white/10 backdrop-blur-sm rounded-lg px-3 py-2 border border-white/20" data-tooltip="System Health Status">
            <div class="flex items-center space-x-1.5">
              <!-- Database Status -->
              <div class="flex items-center space-x-1" data-tooltip="Database Connection">
                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse" id="db-status"></div>
                <i class="fas fa-database text-white/70 text-xs"></i>
              </div>
              
              <!-- Server Status -->
              <div class="flex items-center space-x-1" data-tooltip="Server Performance">
                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse" id="server-status"></div>
                <i class="fas fa-server text-white/70 text-xs"></i>
              </div>
              
              <!-- Cache Status -->
              <div class="flex items-center space-x-1" data-tooltip="Cache System">
                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse" id="cache-status"></div>
                <i class="fas fa-memory text-white/70 text-xs"></i>
              </div>
            </div>
            <span class="text-xs text-white/90 font-medium" id="system-status-text">All Systems Operational</span>
          </div>
        
          <!-- User Role Badge -->
          <% case current_user&.role %>
          <% when 'admin' %>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-500/20 text-red-100 border border-red-400/30">
              <i class="fas fa-crown mr-1.5"></i>
              System Administrator
            </span>
          <% when 'moderator' %>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-500/20 text-yellow-100 border border-yellow-400/30">
              <i class="fas fa-shield-alt mr-1.5"></i>
              Forum Moderator
            </span>
          <% else %>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/20 text-white border border-white/30">
              <i class="fas fa-user mr-1.5"></i>
              <%= current_user&.role&.humanize || 'User' %>
            </span>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content - Compact Table Layout -->
  <div class="p-6 max-w-7xl mx-auto">
    <div class="bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm rounded-2xl border border-white/20 dark:border-gray-700/50 p-6 shadow-xl">
      <div class="bg-gradient-to-r from-white/40 via-white/60 to-white/40 dark:from-gray-800/40 dark:via-gray-800/60 dark:to-gray-800/40 rounded-xl p-1 mb-6 shadow-inner">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-4">
  <!-- Primary Statistics Grid - Centered & Bold Clickable Cards -->
  <section aria-labelledby="statistics-heading" class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8">
    <h2 id="statistics-heading" class="sr-only">Forum Statistics Overview</h2>
    
    <!-- Total Users -->
    <%= link_to admin_users_path, class: "bg-gradient-to-br from-white via-blue-50/50 to-blue-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-blue-200/50 dark:border-blue-700/30 p-8 m-3 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm", role: "button", "aria-label" => "View all users. Total users: #{number_with_delimiter(@stats[:users][:total])}, #{@stats[:users][:new_today]} new today", tabindex: "0" do %>
      <div class="flex flex-col items-center text-center space-y-4 px-6 py-2">
        <div class="p-4 bg-blue-100 dark:bg-blue-900/30 rounded-xl group-hover:scale-110 group-hover:bg-blue-200 dark:group-hover:bg-blue-900/50 transition-all duration-200" aria-hidden="true">
          <i class="fas fa-users text-blue-600 dark:text-blue-400 text-3xl" aria-hidden="true"></i>
        </div>
        <div class="w-full px-4">
          <p class="text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Users</p>
          <h3 class="text-3xl font-bold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors break-words">
            <%= number_with_delimiter(@stats[:users][:total]) %>
          </h3>
          <p class="text-sm font-bold text-green-600 dark:text-green-400 mt-2">+<%= @stats[:users][:new_today] %> today</p>
        </div>
      </div>
    <% end %>

    <!-- Total Posts -->
    <%= link_to admin_posts_path, class: "bg-gradient-to-br from-white via-green-50/50 to-green-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-green-200/50 dark:border-green-700/30 p-8 m-3 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm", role: "button", "aria-label" => "View all posts. Total posts: #{number_with_delimiter(@stats[:posts][:total])}, #{@stats[:posts][:new_today]} new today", tabindex: "0" do %>
      <div class="flex flex-col items-center text-center space-y-4 px-6 py-2">
        <div class="p-4 bg-green-100 dark:bg-green-900/30 rounded-xl group-hover:scale-110 group-hover:bg-green-200 dark:group-hover:bg-green-900/50 transition-all duration-200" aria-hidden="true">
          <i class="fas fa-newspaper text-green-600 dark:text-green-400 text-3xl" aria-hidden="true"></i>
        </div>
        <div class="w-full px-4">
          <p class="text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Posts</p>
          <h3 class="text-3xl font-bold text-gray-900 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors break-words">
            <%= number_with_delimiter(@stats[:posts][:total]) %>
          </h3>
          <p class="text-sm font-bold text-green-600 dark:text-green-400 mt-2">+<%= @stats[:posts][:new_today] %> today</p>
        </div>
      </div>
    <% end %>

    <!-- Total Comments -->
    <%= link_to admin_comments_path, class: "bg-gradient-to-br from-white via-yellow-50/50 to-yellow-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-yellow-200/50 dark:border-yellow-700/30 p-8 m-3 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
      <div class="flex flex-col items-center text-center space-y-4 px-6 py-2">
        <div class="p-4 bg-yellow-100 dark:bg-yellow-900/30 rounded-xl group-hover:scale-110 group-hover:bg-yellow-200 dark:group-hover:bg-yellow-900/50 transition-all duration-200" aria-hidden="true">
          <i class="fas fa-comments text-yellow-600 dark:text-yellow-400 text-3xl" aria-hidden="true"></i>
        </div>
        <div class="w-full px-4">
          <p class="text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Comments</p>
          <h3 class="text-3xl font-bold text-gray-900 dark:text-white group-hover:text-yellow-600 dark:group-hover:text-yellow-400 transition-colors break-words">
            <%= number_with_delimiter(@stats[:comments][:total]) %>
          </h3>
          <p class="text-sm font-bold text-green-600 dark:text-green-400 mt-2">+<%= @stats[:comments][:new_today] %> today</p>
        </div>
      </div>
    <% end %>

    <!-- Categories -->
    <%= link_to admin_categories_path, class: "bg-gradient-to-br from-white via-purple-50/50 to-purple-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-purple-200/50 dark:border-purple-700/30 p-8 m-3 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
      <div class="flex flex-col items-center text-center space-y-4 px-6 py-2">
        <div class="p-4 bg-purple-100 dark:bg-purple-900/30 rounded-xl group-hover:scale-110 group-hover:bg-purple-200 dark:group-hover:bg-purple-900/50 transition-all duration-200" aria-hidden="true">
          <i class="fas fa-tags text-purple-600 dark:text-purple-400 text-3xl" aria-hidden="true"></i>
        </div>
        <div class="w-full px-4">
          <p class="text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Categories</p>
          <h3 class="text-3xl font-bold text-gray-900 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors break-words">
            <%= number_with_delimiter(@stats[:categories][:total]) %>
          </h3>
          <p class="text-sm font-bold text-gray-500 dark:text-gray-400 mt-2">
            <%= @stats[:categories][:with_posts] %> active
          </p>
        </div>
      </div>
    <% end %>

  </div>



    <!-- Secondary Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      
      <!-- Quick Actions Section -->
      <div class="lg:col-span-1">
        <!-- Quick Actions Grid - Centered & Bold Clickable Cards -->
        <div class="grid grid-cols-2 gap-8 mb-6">
          
          <!-- Add User Action -->
          <%= link_to new_admin_user_path, class: "bg-gradient-to-br from-white via-blue-50/40 to-blue-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-blue-200/40 dark:border-blue-700/30 p-8 m-2 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
            <div class="flex flex-col items-center text-center space-y-4 px-4 py-2">
              <div class="p-3 bg-blue-100 dark:bg-blue-900/30 rounded-xl group-hover:scale-110 group-hover:bg-blue-200 dark:group-hover:bg-blue-900/50 transition-all duration-200">
                <i class="fas fa-user-plus text-blue-600 dark:text-blue-400 text-2xl"></i>
              </div>
              <div class="w-full px-2">
                <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Add User</p>
                <p class="text-base font-bold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors break-words">
                  Create Account
                </p>
              </div>
            </div>
          <% end %>

          <!-- Create Post Action -->
          <%= link_to new_admin_post_path, class: "bg-gradient-to-br from-white via-green-50/40 to-green-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-green-200/40 dark:border-green-700/30 p-8 m-2 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
            <div class="flex flex-col items-center text-center space-y-4 px-4 py-2">
              <div class="p-3 bg-green-100 dark:bg-green-900/30 rounded-xl group-hover:scale-110 group-hover:bg-green-200 dark:group-hover:bg-green-900/50 transition-all duration-200">
                <i class="fas fa-plus text-green-600 dark:text-green-400 text-2xl"></i>
              </div>
              <div class="w-full px-2">
                <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">New Post</p>
                <p class="text-base font-bold text-gray-900 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors break-words">
                  Create Content
                </p>
              </div>
            </div>
          <% end %>

          <!-- Moderate Comments Action -->
          <%= link_to admin_comments_path, class: "bg-gradient-to-br from-white via-yellow-50/40 to-yellow-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-yellow-200/40 dark:border-yellow-700/30 p-8 m-2 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
            <div class="flex flex-col items-center text-center space-y-4 px-4 py-2">
              <div class="p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-xl group-hover:scale-110 group-hover:bg-yellow-200 dark:group-hover:bg-yellow-900/50 transition-all duration-200">
                <i class="fas fa-shield-alt text-yellow-600 dark:text-yellow-400 text-2xl"></i>
              </div>
              <div class="w-full px-2">
                <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Moderate</p>
                <p class="text-base font-bold text-gray-900 dark:text-white group-hover:text-yellow-600 dark:group-hover:text-yellow-400 transition-colors break-words">
                  Review Content
                </p>
              </div>
            </div>
          <% end %>

          <!-- Export Data Action -->
          <%= link_to export_admin_users_path(format: 'csv'), class: "bg-gradient-to-br from-white via-purple-50/40 to-purple-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-purple-200/40 dark:border-purple-700/30 p-8 m-2 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
            <div class="flex flex-col items-center text-center space-y-4 px-4 py-2">
              <div class="p-3 bg-purple-100 dark:bg-purple-900/30 rounded-xl group-hover:scale-110 group-hover:bg-purple-200 dark:group-hover:bg-purple-900/50 transition-all duration-200">
                <i class="fas fa-download text-purple-600 dark:text-purple-400 text-2xl"></i>
              </div>
              <div class="w-full px-2">
                <p class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Export</p>
                <p class="text-base font-bold text-gray-900 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors break-words">
                  Download Data
                </p>
              </div>
            </div>
          <% end %>
          
        </div>
        
        <!-- Notifications Section -->
        <section aria-labelledby="notifications-heading" class="bg-gradient-to-br from-white via-orange-50/30 to-orange-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-orange-200/40 dark:border-orange-700/30 p-5 shadow-lg backdrop-blur-sm mb-6">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center space-x-2">
              <div class="p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg" aria-hidden="true">
                <i class="fas fa-bell text-orange-600 dark:text-orange-400 text-sm" aria-hidden="true"></i>
              </div>
              <div>
                <h3 id="notifications-heading" class="text-sm font-semibold text-gray-900 dark:text-white">System Alerts</h3>
                <p class="text-xs text-gray-500 dark:text-gray-400">Recent notifications</p>
              </div>
            </div>
            <button class="text-xs text-orange-600 dark:text-orange-400 hover:underline font-medium" onclick="clearAllNotifications()" aria-label="Clear all notifications">
              Clear all
            </button>
          </div>
          
          <div id="notification-container" class="space-y-2 max-h-48 overflow-y-auto" role="log" aria-live="polite" aria-label="System notifications">
            <!-- New User Registration Alert -->
            <% if @stats[:users][:new_today] > 0 %>
              <div class="notification-item bg-gradient-to-r from-blue-50 to-blue-100/50 dark:from-blue-900/20 dark:to-blue-900/40 border border-blue-200/50 dark:border-blue-700/30 rounded-lg p-4 flex items-center justify-between group hover:shadow-md transition-all duration-200 mx-2">
                <div class="flex items-center space-x-4 flex-1">
                  <div class="p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg">
                    <i class="fas fa-user-plus text-blue-600 dark:text-blue-400 text-sm"></i>
                  </div>
                  <div class="text-center flex-1">
                    <p class="text-sm font-semibold text-blue-800 dark:text-blue-300"><%= @stats[:users][:new_today] %> new user<%= @stats[:users][:new_today] > 1 ? 's' : '' %> registered today</p>
                    <p class="text-sm text-blue-600 dark:text-blue-400">Click to review new accounts</p>
                  </div>
                </div>
                <button class="opacity-0 group-hover:opacity-100 text-blue-500 hover:text-blue-700 transition-opacity ml-4" onclick="dismissNotification(this)">
                  <i class="fas fa-times text-sm"></i>
                </button>
              </div>
            <% end %>
            
            <!-- High Activity Alert -->
            <% if @stats[:posts][:new_today] > 10 %>
              <div class="notification-item bg-gradient-to-r from-green-50 to-green-100/50 dark:from-green-900/20 dark:to-green-900/40 border border-green-200/50 dark:border-green-700/30 rounded-lg p-3 flex items-center justify-between group hover:shadow-md transition-all duration-200">
                <div class="flex items-center space-x-3">
                  <div class="p-1.5 bg-green-100 dark:bg-green-900/50 rounded-lg">
                    <i class="fas fa-chart-line text-green-600 dark:text-green-400 text-xs"></i>
                  </div>
                  <div>
                    <p class="text-xs font-semibold text-green-800 dark:text-green-300">High activity today: <%= @stats[:posts][:new_today] %> new posts</p>
                    <p class="text-xs text-green-600 dark:text-green-400">Forum engagement is up</p>
                  </div>
                </div>
                <button class="opacity-0 group-hover:opacity-100 text-green-500 hover:text-green-700 transition-opacity" onclick="dismissNotification(this)">
                  <i class="fas fa-times text-xs"></i>
                </button>
              </div>
            <% end %>
            
            <!-- Comments to Moderate Alert -->
            <% if @stats[:comments][:pending_moderation] && @stats[:comments][:pending_moderation] > 0 %>
              <div class="notification-item bg-gradient-to-r from-red-50 to-red-100/50 dark:from-red-900/20 dark:to-red-900/40 border border-red-200/50 dark:border-red-700/30 rounded-lg p-3 flex items-center justify-between group hover:shadow-md transition-all duration-200">
                <div class="flex items-center space-x-3">
                  <div class="p-1.5 bg-red-100 dark:bg-red-900/50 rounded-lg">
                    <i class="fas fa-flag text-red-600 dark:text-red-400 text-xs"></i>
                  </div>
                  <div>
                    <p class="text-xs font-semibold text-red-800 dark:text-red-300"><%= @stats[:comments][:pending_moderation] %> comment<%= @stats[:comments][:pending_moderation] > 1 ? 's' : '' %> need<%= @stats[:comments][:pending_moderation] == 1 ? 's' : '' %> moderation</p>
                    <p class="text-xs text-red-600 dark:text-red-400">Requires immediate attention</p>
                  </div>
                </div>
                <button class="opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 transition-opacity" onclick="dismissNotification(this)">
                  <i class="fas fa-times text-xs"></i>
                </button>
              </div>
            <% end %>
            
            <!-- System Status Alert -->
            <div class="notification-item bg-gradient-to-r from-purple-50 to-purple-100/50 dark:from-purple-900/20 dark:to-purple-900/40 border border-purple-200/50 dark:border-purple-700/30 rounded-lg p-4 flex items-center justify-between group hover:shadow-md transition-all duration-200 mx-2">
              <div class="flex items-center space-x-4 flex-1">
                <div class="p-2 bg-purple-100 dark:bg-purple-900/50 rounded-lg">
                  <i class="fas fa-server text-purple-600 dark:text-purple-400 text-sm"></i>
                </div>
                <div class="text-center flex-1">
                  <p class="text-sm font-semibold text-purple-800 dark:text-purple-300">System running smoothly</p>
                  <p class="text-sm text-purple-600 dark:text-purple-400">All services operational</p>
                </div>
              </div>
              <div class="flex items-center space-x-2 ml-4">
                <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                <span class="text-sm text-green-600 dark:text-green-400 font-medium">Online</span>
              </div>
            </div>
            
            <!-- No notifications placeholder -->
            <div id="no-notifications" class="hidden text-center py-6">
              <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg mb-3 mx-auto w-12 h-12 flex items-center justify-center">
                <i class="fas fa-bell-slash text-gray-400 dark:text-gray-500"></i>
              </div>
              <p class="text-xs font-medium text-gray-500 dark:text-gray-400">No new notifications</p>
            </div>
          </div>
        </div>
        
        <!-- System Status Section -->
        <div class="bg-gradient-to-br from-white via-indigo-50/30 to-indigo-100/20 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-indigo-200/40 dark:border-indigo-700/30 p-5 shadow-lg backdrop-blur-sm mb-6">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center space-x-2">
              <div class="p-2 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg">
                <i class="fas fa-heartbeat text-indigo-600 dark:text-indigo-400 text-sm"></i>
              </div>
              <div>
                <h3 class="text-sm font-semibold text-gray-900 dark:text-white">System Health</h3>
                <p class="text-xs text-gray-500 dark:text-gray-400">Real-time monitoring</p>
              </div>
            </div>
            <div class="flex items-center space-x-1">
              <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
              <span class="text-xs text-green-600 dark:text-green-400 font-medium">Healthy</span>
            </div>
          </div>
          
          <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
            <!-- Server Load -->
            <div class="bg-gradient-to-br from-blue-50 to-blue-100/50 dark:from-blue-900/20 dark:to-blue-900/40 rounded-lg p-6 m-2 border border-blue-200/30 dark:border-blue-700/30">
              <div class="flex items-center justify-between mb-4 px-2">
                <i class="fas fa-tachometer-alt text-blue-600 dark:text-blue-400 text-base"></i>
                <span class="text-sm font-medium text-blue-800 dark:text-blue-300">CPU</span>
              </div>
              <div class="text-xl font-bold text-blue-900 dark:text-blue-100 mb-3 px-2" id="cpu-usage">23%</div>
              <div class="w-full bg-blue-200 dark:bg-blue-800/50 rounded-full h-2 mx-2" style="width: calc(100% - 1rem);">
                <div class="bg-blue-500 h-2 rounded-full transition-all duration-500" style="width: 23%" id="cpu-bar"></div>
              </div>
            </div>
            
            <!-- Memory Usage -->
            <div class="bg-gradient-to-br from-green-50 to-green-100/50 dark:from-green-900/20 dark:to-green-900/40 rounded-lg p-6 m-2 border border-green-200/30 dark:border-green-700/30">
              <div class="flex items-center justify-between mb-4 px-2">
                <i class="fas fa-memory text-green-600 dark:text-green-400 text-base"></i>
                <span class="text-sm font-medium text-green-800 dark:text-green-300">RAM</span>
              </div>
              <div class="text-xl font-bold text-green-900 dark:text-green-100 mb-3 px-2" id="memory-usage">67%</div>
              <div class="w-full bg-green-200 dark:bg-green-800/50 rounded-full h-2 mx-2" style="width: calc(100% - 1rem);">
                <div class="bg-green-500 h-2 rounded-full transition-all duration-500" style="width: 67%" id="memory-bar"></div>
              </div>
            </div>
            
            <!-- Storage -->
            <div class="bg-gradient-to-br from-yellow-50 to-yellow-100/50 dark:from-yellow-900/20 dark:to-yellow-900/40 rounded-lg p-6 m-2 border border-yellow-200/30 dark:border-yellow-700/30">
              <div class="flex items-center justify-between mb-4 px-2">
                <i class="fas fa-hdd text-yellow-600 dark:text-yellow-400 text-base"></i>
                <span class="text-sm font-medium text-yellow-800 dark:text-yellow-300">Storage</span>
              </div>
              <div class="text-xl font-bold text-yellow-900 dark:text-yellow-100 mb-3 px-2" id="storage-usage">45%</div>
              <div class="w-full bg-yellow-200 dark:bg-yellow-800/50 rounded-full h-2 mx-2" style="width: calc(100% - 1rem);">
                <div class="bg-yellow-500 h-2 rounded-full transition-all duration-500" style="width: 45%" id="storage-bar"></div>
              </div>
            </div>
            
            <!-- Response Time -->
            <div class="bg-gradient-to-br from-purple-50 to-purple-100/50 dark:from-purple-900/20 dark:to-purple-900/40 rounded-lg p-6 m-2 border border-purple-200/30 dark:border-purple-700/30">
              <div class="flex items-center justify-between mb-4 px-2">
                <i class="fas fa-clock text-purple-600 dark:text-purple-400 text-base"></i>
                <span class="text-sm font-medium text-purple-800 dark:text-purple-300">Response</span>
              </div>
              <div class="text-xl font-bold text-purple-900 dark:text-purple-100 mb-3 px-2" id="response-time">120ms</div>
              <div class="flex items-center px-2">
                <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                <span class="text-sm text-purple-700 dark:text-purple-300 font-medium">Excellent</span>
              </div>
            </div>
          </div>
          
          <!-- System Components Status -->
          <div class="mt-6 pt-4 border-t border-indigo-200/30 dark:border-indigo-700/30">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm">
              <div class="flex flex-col items-center text-center p-4 bg-white/50 dark:bg-gray-700/30 rounded-lg mx-2">
                <div class="flex items-center space-x-3 mb-2">
                  <i class="fas fa-database text-indigo-600 dark:text-indigo-400 text-base"></i>
                  <span class="font-semibold text-gray-700 dark:text-gray-300">Database</span>
                </div>
                <div class="flex items-center text-green-600 dark:text-green-400 font-medium">
                  <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                  <span>Healthy</span>
                </div>
              </div>
              
              <div class="flex flex-col items-center text-center p-4 bg-white/50 dark:bg-gray-700/30 rounded-lg mx-2">
                <div class="flex items-center space-x-3 mb-2">
                  <i class="fas fa-cloud text-indigo-600 dark:text-indigo-400 text-base"></i>
                  <span class="font-semibold text-gray-700 dark:text-gray-300">Redis Cache</span>
                </div>
                <div class="flex items-center text-green-600 dark:text-green-400 font-medium">
                  <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                  <span>Running</span>
                </div>
              </div>
              
              <div class="flex flex-col items-center text-center p-4 bg-white/50 dark:bg-gray-700/30 rounded-lg mx-2">
                <div class="flex items-center space-x-3 mb-2">
                  <i class="fas fa-envelope text-indigo-600 dark:text-indigo-400 text-base"></i>
                  <span class="font-semibold text-gray-700 dark:text-gray-300">Mail Service</span>
                </div>
                <div class="flex items-center text-green-600 dark:text-green-400 font-medium">
                  <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                  <span>Active</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Recent Users Section -->
        <div class="space-y-6">
          <div class="flex flex-col items-center text-center space-y-4">
            <div class="flex items-center space-x-3">
              <div class="p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg">
                <i class="fas fa-user-clock text-blue-600 dark:text-blue-400 text-base"></i>
              </div>
              <h3 class="text-base font-semibold text-gray-900 dark:text-white">Recent Users</h3>
            </div>
            
            <div class="flex items-center justify-between w-full">
              <!-- User Filter Dropdown -->
              <div class="relative">
                <select id="userFilter" onchange="filterUsers(this.value)" class="text-sm bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-1 focus:ring-2 focus:ring-blue-500 appearance-none cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                  <option value="all">All users</option>
                  <option value="admin">Admins only</option>
                  <option value="moderator">Moderators only</option>
                  <option value="user">Regular users</option>
                  <option value="today">Joined today</option>
                  <option value="week">This week</option>
                </select>
                <i class="fas fa-chevron-down text-sm text-gray-400 absolute right-3 top-1.5 pointer-events-none"></i>
              </div>
              
              <%= link_to admin_users_path, class: "text-sm text-blue-600 dark:text-blue-400 hover:underline font-medium" do %>
                View all →
              <% end %>
            </div>
          </div>
          
          <div id="recent-users-container" class="grid grid-cols-1 gap-6">
            <% @recent_users.limit(4).each do |user| %>
              <%= link_to admin_user_path(user), class: "user-card bg-gradient-to-r from-white via-blue-50/30 to-white dark:bg-gradient-to-r dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-blue-200/30 dark:border-blue-700/20 p-6 m-3 shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm", data: { role: user.role, join_date: user.created_at.iso8601 } do %>
                <div class="flex items-center space-x-6 px-2">
                  <% if user.avatar.attached? %>
                    <%= image_tag user.avatar, class: "w-12 h-12 rounded-full object-cover group-hover:scale-110 transition-transform duration-200" %>
                  <% else %>
                    <div class="w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center group-hover:scale-110 transition-transform duration-200">
                      <span class="text-base font-bold text-white"><%= user.username&.first&.upcase || 'U' %></span>
                    </div>
                  <% end %>
                  <div class="flex-1 min-w-0 pr-4">
                    <p class="text-base font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"><%= truncate(user.display_name, length: 20) %></p>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Joined <%= time_ago_in_words(user.created_at) %> ago</p>
                  </div>
                  <span class="inline-flex items-center px-3 py-1.5 rounded-full text-sm font-bold <%= case user.role
                    when 'admin' then 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'
                    when 'moderator' then 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400'
                    else 'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300'
                  end %> ml-2">
                    <%= user.role.capitalize %>
                  </span>
                </div>
              <% end %>
            <% end %>
            
            <% if @recent_users.limit(4).count == 0 %>
              <div class="bg-gradient-to-br from-white via-gray-50/50 to-gray-100/30 dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-gray-200/50 dark:border-gray-700/30 p-6 shadow-lg text-center backdrop-blur-sm">
                <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg mb-3 mx-auto w-12 h-12 flex items-center justify-center">
                  <i class="fas fa-users text-gray-400 dark:text-gray-500"></i>
                </div>
                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">No recent users</p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
      
      <!-- Charts Section -->
      <div class="lg:col-span-2">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6">
          <!-- User Growth Chart -->
          <div class="bg-gradient-to-br from-white via-blue-50/30 to-white dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-blue-200/40 dark:border-blue-700/30 p-5 shadow-lg backdrop-blur-sm">
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center space-x-2">
                <div class="p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg">
                  <i class="fas fa-chart-line text-blue-600 dark:text-blue-400 text-sm"></i>
                </div>
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 dark:text-white">User Growth</h3>
                  <p class="text-xs text-gray-500 dark:text-gray-400">Last 30 days</p>
                </div>
              </div>
              <div class="flex space-x-1">
                <button class="px-3 py-1.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" onclick="filterActivityData('week')">
                  7D
                </button>
                <button class="px-3 py-1.5 text-xs bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-lg">
                  30D
                </button>
              </div>
            </div>
            <div class="relative" style="height: 200px;">
              <canvas id="userGrowthChart" class="w-full h-full"></canvas>
            </div>
          </div>
          
          <!-- Content Activity Chart -->
          <div class="bg-gradient-to-br from-white via-green-50/30 to-white dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-green-200/40 dark:border-green-700/30 p-5 shadow-lg backdrop-blur-sm">
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center space-x-2">
                <div class="p-2 bg-green-100 dark:bg-green-900/30 rounded-lg">
                  <i class="fas fa-chart-bar text-green-600 dark:text-green-400 text-sm"></i>
                </div>
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 dark:text-white">Content Activity</h3>
                  <p class="text-xs text-gray-500 dark:text-gray-400">Posts & Comments</p>
                </div>
              </div>
              <div class="flex items-center space-x-4 text-xs">
                <div class="flex items-center">
                  <div class="w-2 h-2 bg-green-500 rounded-full mr-1.5"></div>
                  <span class="text-gray-600 dark:text-gray-400 font-medium">Posts</span>
                </div>
                <div class="flex items-center">
                  <div class="w-2 h-2 bg-yellow-500 rounded-full mr-1.5"></div>
                  <span class="text-gray-600 dark:text-gray-400 font-medium">Comments</span>
                </div>
              </div>
            </div>
            <div class="relative" style="height: 200px;">
              <canvas id="contentActivityChart" class="w-full h-full"></canvas>
            </div>
          </div>
        </div>
        
        <!-- Recent Posts & Comments as Individual Cards -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          
          <!-- Recent Posts -->
          <div class="space-y-6">
            <div class="flex flex-col items-center text-center space-y-4">
              <div class="flex items-center space-x-3">
                <div class="p-3 bg-green-100 dark:bg-green-900/30 rounded-lg">
                  <i class="fas fa-newspaper text-green-600 dark:text-green-400 text-base"></i>
                </div>
                <h3 class="text-base font-semibold text-gray-900 dark:text-white">Recent Posts</h3>
              </div>
              
              <div class="flex items-center justify-between w-full">
                <!-- Posts Filter Dropdown -->
                <div class="relative">
                  <select id="postsFilter" onchange="filterPosts(this.value)" class="text-sm bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-1 focus:ring-2 focus:ring-green-500 appearance-none cursor-pointer hover:text-green-600 dark:hover:text-green-400 transition-colors">
                    <option value="all">All posts</option>
                    <option value="today">Today</option>
                    <option value="week">This week</option>
                    <option value="popular">Most popular</option>
                    <% if defined?(@categories) && @categories %>
                      <% @categories.each do |category| %>
                        <option value="category_<%= category.id %>"><%= category.name %></option>
                      <% end %>
                    <% end %>
                  </select>
                  <i class="fas fa-chevron-down text-sm text-gray-400 absolute right-3 top-1.5 pointer-events-none"></i>
                </div>
                
                <%= link_to admin_posts_path, class: "text-sm text-blue-600 dark:text-blue-400 hover:underline font-medium" do %>
                  View all →
                <% end %>
              </div>
            </div>
            
            <div id="recent-posts-container" class="space-y-6">
              <% @recent_posts.limit(3).each do |post| %>
                <%= link_to post_path(post), class: "post-card block bg-gradient-to-r from-white via-green-50/30 to-white dark:bg-gradient-to-r dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-green-200/30 dark:border-green-700/20 p-6 m-3 shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm", data: { post_date: post.created_at.iso8601, category_id: post.category.id } do %>
                  <div class="flex items-start space-x-6 px-2">
                    <div class="p-3 bg-green-100 dark:bg-green-900/30 rounded-lg group-hover:scale-110 transition-transform duration-200">
                      <i class="fas fa-newspaper text-green-600 dark:text-green-400 text-base"></i>
                    </div>
                    <div class="flex-1 min-w-0 pr-4">
                      <p class="text-base font-bold text-gray-900 dark:text-white line-clamp-2 mb-3 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors">
                        <%= truncate(post.title, length: 45) %>
                      </p>
                      <div class="flex items-center justify-between flex-wrap gap-3">
                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">
                          by <%= truncate(post.user.display_name, length: 18) %> • <%= time_ago_in_words(post.created_at) %> ago
                        </p>
                        <span class="inline-flex items-center px-3 py-1.5 rounded-full text-sm font-bold bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400">
                          <%= truncate(post.category.name, length: 12) %>
                        </span>
                      </div>
                    </div>
                  </div>
                <% end %>
              <% end %>
              
              <% if @recent_posts.limit(3).count == 0 %>
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm text-center">
                  <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg mb-3 mx-auto w-12 h-12 flex items-center justify-center">
                    <i class="fas fa-newspaper text-gray-400 dark:text-gray-500"></i>
                  </div>
                  <p class="text-sm font-medium text-gray-500 dark:text-gray-400">No recent posts</p>
                </div>
              <% end %>
            </div>
          </div>
          
          <!-- Recent Comments -->
          <div class="space-y-6">
            <div class="flex flex-col items-center text-center space-y-4">
              <div class="flex items-center space-x-3">
                <div class="p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg">
                  <i class="fas fa-comments text-yellow-600 dark:text-yellow-400 text-base"></i>
                </div>
                <h3 class="text-base font-semibold text-gray-900 dark:text-white">Recent Comments</h3>
              </div>
              
              <div class="flex items-center justify-center w-full">
                <%= link_to admin_comments_path, class: "text-sm text-blue-600 dark:text-blue-400 hover:underline font-medium" do %>
                  Moderate →
                <% end %>
              </div>
            </div>
            
            <div class="space-y-6">
              <% @recent_comments.limit(3).each do |comment| %>
                <%= link_to post_path(comment.post), class: "block bg-gradient-to-r from-white via-yellow-50/30 to-white dark:bg-gradient-to-r dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-xl border border-yellow-200/30 dark:border-yellow-700/20 p-6 m-3 shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300 group cursor-pointer transform active:scale-95 backdrop-blur-sm" do %>
                  <div class="flex items-start space-x-6 px-2">
                    <div class="p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg group-hover:scale-110 transition-transform duration-200">
                      <i class="fas fa-comments text-yellow-600 dark:text-yellow-400 text-base"></i>
                    </div>
                    <div class="flex-1 min-w-0 pr-4">
                      <p class="text-base font-bold text-gray-700 dark:text-gray-300 line-clamp-2 mb-3 group-hover:text-yellow-600 dark:group-hover:text-yellow-400 transition-colors">
                        <%= truncate(strip_tags(comment.content), length: 65) %>
                      </p>
                      <div class="flex items-center justify-between flex-wrap gap-3">
                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">
                          by <%= truncate(comment.user.display_name, length: 15) %> • <%= time_ago_in_words(comment.created_at) %> ago
                        </p>
                        <span class="inline-flex items-center px-3 py-1.5 rounded-full text-sm font-bold bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400">
                          <%= truncate(comment.post.title, length: 18) %>
                        </span>
                      </div>
                    </div>
                  </div>
                <% end %>
              <% end %>
              
              <% if @recent_comments.limit(3).count == 0 %>
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm text-center">
                  <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg mb-3 mx-auto w-12 h-12 flex items-center justify-center">
                    <i class="fas fa-comments text-gray-400 dark:text-gray-500"></i>
                  </div>
                  <p class="text-sm font-medium text-gray-500 dark:text-gray-400">No recent comments</p>
                </div>
              <% end %>
            </div>
          </div>
          
        </div>
      </div>
      
    </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Dashboard Chart Data -->
<script>
  // Set chart data as global variables for the admin_dashboard.js module
  window.userGrowthLabels = <%= raw @user_growth_data.keys.to_json %>;
  window.userGrowthData = <%= raw @user_growth_data.values.to_json %>;
  window.postActivityLabels = <%= raw @post_activity_data.keys.to_json %>;
  window.postActivityData = <%= raw @post_activity_data.values.to_json %>;
  window.commentActivityData = <%= raw @comment_activity_data.values.to_json %>;
  
  // Notification System Functions
  function dismissNotification(button) {
    const notificationItem = button.closest('.notification-item');
    notificationItem.style.transform = 'translateX(100%)';
    notificationItem.style.opacity = '0';
    
    setTimeout(() => {
      notificationItem.remove();
      checkIfNotificationsEmpty();
    }, 300);
  }
  
  function clearAllNotifications() {
    const notifications = document.querySelectorAll('.notification-item');
    notifications.forEach((notification, index) => {
      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        notification.style.opacity = '0';
        
        setTimeout(() => {
          notification.remove();
          if (index === notifications.length - 1) {
            checkIfNotificationsEmpty();
          }
        }, 300);
      }, index * 100);
    });
  }
  
  function checkIfNotificationsEmpty() {
    const container = document.getElementById('notification-container');
    const notifications = container.querySelectorAll('.notification-item');
    const noNotificationsMsg = document.getElementById('no-notifications');
    
    if (notifications.length === 0) {
      noNotificationsMsg.classList.remove('hidden');
    } else {
      noNotificationsMsg.classList.add('hidden');
    }
  }
  
  // Auto-refresh notifications every 5 minutes
  setInterval(() => {
    // In a real application, you would fetch new notifications via AJAX
    console.log('Checking for new notifications...');
  }, 300000); // 5 minutes
  
  // Filter functions for activity data
  function filterActivityData(period) {
    // Update chart time period buttons
    document.querySelectorAll('[onclick*="filterActivityData"]').forEach(btn => {
      btn.classList.remove('bg-blue-100', 'dark:bg-blue-900/50', 'text-blue-700', 'dark:text-blue-300');
      btn.classList.add('bg-gray-100', 'dark:bg-gray-700', 'text-gray-600', 'dark:text-gray-300');
    });
    
    event.target.classList.remove('bg-gray-100', 'dark:bg-gray-700', 'text-gray-600', 'dark:text-gray-300');
    event.target.classList.add('bg-blue-100', 'dark:bg-blue-900/50', 'text-blue-700', 'dark:text-blue-300');
    
    // In a real application, you would update the charts with filtered data
    console.log('Filtering data for period:', period);
  }
  
  // Filter users function
  function filterUsers(filterType) {
    const userCards = document.querySelectorAll('#recent-users-container .user-card');
    
    userCards.forEach(card => {
      let shouldShow = true;
      
      if (filterType === 'admin') {
        shouldShow = card.dataset.role === 'admin';
      } else if (filterType === 'moderator') {
        shouldShow = card.dataset.role === 'moderator';
      } else if (filterType === 'user') {
        shouldShow = card.dataset.role === 'user' || card.dataset.role === 'member';
      } else if (filterType === 'today') {
        const joinDate = new Date(card.dataset.joinDate);
        const today = new Date();
        shouldShow = joinDate.toDateString() === today.toDateString();
      } else if (filterType === 'week') {
        const joinDate = new Date(card.dataset.joinDate);
        const weekAgo = new Date();
        weekAgo.setDate(weekAgo.getDate() - 7);
        shouldShow = joinDate >= weekAgo;
      }
      
      if (shouldShow) {
        card.style.display = 'block';
        card.style.opacity = '1';
        card.style.transform = 'scale(1)';
      } else {
        card.style.opacity = '0';
        card.style.transform = 'scale(0.95)';
        setTimeout(() => {
          card.style.display = 'none';
        }, 200);
      }
    });
  }
  
  // Filter posts function
  function filterPosts(filterType) {
    const postCards = document.querySelectorAll('#recent-posts-container .post-card');
    
    postCards.forEach(card => {
      let shouldShow = true;
      
      if (filterType === 'today') {
        const postDate = new Date(card.dataset.postDate);
        const today = new Date();
        shouldShow = postDate.toDateString() === today.toDateString();
      } else if (filterType === 'week') {
        const postDate = new Date(card.dataset.postDate);
        const weekAgo = new Date();
        weekAgo.setDate(weekAgo.getDate() - 7);
        shouldShow = postDate >= weekAgo;
      } else if (filterType === 'popular') {
        // Sort by comment count or engagement (mockup - you'd implement proper sorting)
        shouldShow = true;
      } else if (filterType.startsWith('category_')) {
        const categoryId = filterType.replace('category_', '');
        shouldShow = card.dataset.categoryId === categoryId;
      }
      
      if (shouldShow) {
        card.style.display = 'block';
        card.style.opacity = '1';
        card.style.transform = 'scale(1)';
      } else {
        card.style.opacity = '0';
        card.style.transform = 'scale(0.95)';
        setTimeout(() => {
          card.style.display = 'none';
        }, 200);
      }
    });
  }
  
  // System Monitoring Functions
  function updateSystemMetrics() {
    // Simulate realistic system metrics
    const metrics = {
      cpu: Math.floor(Math.random() * 30) + 15, // 15-45%
      memory: Math.floor(Math.random() * 40) + 50, // 50-90%
      storage: Math.floor(Math.random() * 20) + 40, // 40-60%
      responseTime: Math.floor(Math.random() * 100) + 80 // 80-180ms
    };
    
    // Update CPU
    const cpuUsage = document.getElementById('cpu-usage');
    const cpuBar = document.getElementById('cpu-bar');
    if (cpuUsage && cpuBar) {
      cpuUsage.textContent = metrics.cpu + '%';
      cpuBar.style.width = metrics.cpu + '%';
      
      // Change color based on usage
      if (metrics.cpu > 80) {
        cpuBar.className = cpuBar.className.replace('bg-blue-500', 'bg-red-500');
      } else if (metrics.cpu > 60) {
        cpuBar.className = cpuBar.className.replace('bg-blue-500', 'bg-yellow-500');
      } else {
        cpuBar.className = cpuBar.className.replace(/bg-(red|yellow)-500/, 'bg-blue-500');
      }
    }
    
    // Update Memory
    const memoryUsage = document.getElementById('memory-usage');
    const memoryBar = document.getElementById('memory-bar');
    if (memoryUsage && memoryBar) {
      memoryUsage.textContent = metrics.memory + '%';
      memoryBar.style.width = metrics.memory + '%';
      
      // Change color based on usage
      if (metrics.memory > 85) {
        memoryBar.className = memoryBar.className.replace('bg-green-500', 'bg-red-500');
      } else if (metrics.memory > 70) {
        memoryBar.className = memoryBar.className.replace('bg-green-500', 'bg-yellow-500');
      } else {
        memoryBar.className = memoryBar.className.replace(/bg-(red|yellow)-500/, 'bg-green-500');
      }
    }
    
    // Update Storage
    const storageUsage = document.getElementById('storage-usage');
    const storageBar = document.getElementById('storage-bar');
    if (storageUsage && storageBar) {
      storageUsage.textContent = metrics.storage + '%';
      storageBar.style.width = metrics.storage + '%';
    }
    
    // Update Response Time
    const responseTime = document.getElementById('response-time');
    if (responseTime) {
      responseTime.textContent = metrics.responseTime + 'ms';
    }
    
    // Update system status indicators
    updateSystemStatusIndicators(metrics);
  }
  
  function updateSystemStatusIndicators(metrics) {
    const dbStatus = document.getElementById('db-status');
    const serverStatus = document.getElementById('server-status');
    const cacheStatus = document.getElementById('cache-status');
    const systemStatusText = document.getElementById('system-status-text');
    
    // Simulate occasional issues
    const hasIssues = Math.random() < 0.05; // 5% chance of issues
    
    if (hasIssues) {
      // Show warning state
      if (dbStatus) {
        dbStatus.className = 'w-2 h-2 bg-yellow-400 rounded-full animate-pulse';
      }
      if (systemStatusText) {
        systemStatusText.textContent = 'Minor Issues Detected';
      }
    } else {
      // Show healthy state
      if (dbStatus) {
        dbStatus.className = 'w-2 h-2 bg-green-400 rounded-full animate-pulse';
      }
      if (serverStatus) {
        serverStatus.className = 'w-2 h-2 bg-green-400 rounded-full animate-pulse';
      }
      if (cacheStatus) {
        cacheStatus.className = 'w-2 h-2 bg-green-400 rounded-full animate-pulse';
      }
      if (systemStatusText) {
        systemStatusText.textContent = 'All Systems Operational';
      }
    }
  }
  
  // Initialize system monitoring
  document.addEventListener('DOMContentLoaded', function() {
    // Update system metrics every 10 seconds
    setInterval(updateSystemMetrics, 10000);
    
    // Initial update
    updateSystemMetrics();
  });
  
  // Live clock for dashboard
  function updateClock() {
    const now = new Date();
    const timeString = now.toLocaleTimeString();
    const dateString = now.toLocaleDateString('en-US', {
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
    
    // Update if elements exist
    const timeElement = document.querySelector('[data-live-time]');
    const dateElement = document.querySelector('[data-live-date]');
    
    if (timeElement) timeElement.textContent = timeString;
    if (dateElement) dateElement.textContent = dateString;
  }
  
  // Update clock every second
  setInterval(updateClock, 1000);
  updateClock(); // Initial call
</script>

<!-- Accessibility Styles -->
<style>
  /* Screen reader only content */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }
  
  /* Skip links */
  .skip-link:focus {
    position: fixed;
    top: 1rem;
    left: 1rem;
    z-index: 50;
    padding: 0.5rem 1rem;
    background-color: #2563eb;
    color: white;
    text-decoration: none;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }
  
  /* Enhanced focus indicators */
  .focus\:outline-blue:focus {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
  }
  
  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .bg-gradient-to-br {
      background: white;
      border: 2px solid black;
    }
    
    .dark .bg-gradient-to-br {
      background: black;
      border: 2px solid white;
      color: white;
    }
  }
  
  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .animate-pulse,
    .transition-all,
    .hover\:scale-105:hover {
      animation: none;
      transition: none;
      transform: none;
    }
  }
  
  /* Focus visible for better keyboard navigation */
  .focus-visible\:ring:focus-visible {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
    border-radius: 0.375rem;
  }
  
  /* Ensure minimum touch target size */
  button, [role="button"], a {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Improve color contrast for better readability */
  .text-gray-500 {
    color: #4a5568;
  }
  
  .dark .text-gray-500 {
    color: #a0aec0;
  }
</style>
